---
interface Beat {
  id: string;
  title: string;
  bpm: number;
  key: string;
  genre: string[];
  coverImage: string;
  previewUrl: string;
  price: {
    mp3: number;
    wav: number;
    stems: number;
  };
}

const { beat } = Astro.props;
---

<article class="bg-gray-800 rounded-lg overflow-hidden shadow-lg hover:shadow-xl transition-shadow">
  <div class="relative group">
    <img 
      src={beat.coverImage || '/images/placeholder-cover.jpg'} 
      alt={`${beat.title} cover`}
      class="w-full h-48 object-cover"
    />
    <div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
      <button class="play-button bg-secondary text-white rounded-full p-3 hover:scale-110 transition-transform"
              data-audio-src={beat.previewUrl}>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      </button>
    </div>
  </div>
  
  <div class="p-4">
    <div class="flex justify-between items-start">
      <div>
        <h3 class="text-lg font-semibold text-white">{beat.title}</h3>
        <p class="text-gray-400 text-sm">{beat.bpm} BPM • {beat.key}</p>
      </div>
      <div class="text-right">
        <p class="text-lg font-bold text-secondary">${Math.min(...Object.values(beat.price))}</p>
        <p class="text-xs text-gray-400">à partir de</p>
      </div>
    </div>
    
    <div class="mt-3 flex flex-wrap gap-2">
      {beat.genre.map((tag) => (
        <span class="text-xs bg-gray-700 text-gray-300 px-2 py-1 rounded">{tag}</span>
      ))}
    </div>
    
    <div class="mt-4 flex justify-between items-center">
      <a href={`/beats/${beat.id}`} class="text-sm text-secondary hover:underline">Voir détails</a>
      <button class="bg-secondary text-white px-4 py-2 rounded hover:bg-opacity-90 transition-colors">
        Acheter
      </button>
    </div>
  </div>
</article>

<style>
  .play-button {
    transition: transform 0.2s ease, opacity 0.3s ease;
  }
  .play-button:hover {
    transform: scale(1.1);
  }
</style>
